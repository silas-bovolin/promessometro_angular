<div class="promise-card" [class.expanded]="isExpanded">
  <div class="promise-header" (click)="toggleExpand()">
    <div class="promise-info">
      <div class="promise-icon">
      </div>
      <div>
        <h3>{{ promessa.Titulo }}</h3>
        <p>{{ promessa.Descricao }}</p>
      </div>
    </div>
    <div class="promise-progress">
      <div class="circular-progress" [ngStyle]="{ '--progress': promessa.ConclusaoPorcentagem + '%' }">
        <span class="progress-value">{{ promessa.ConclusaoPorcentagem }}%</span>
      </div>
      <i class="icon-chevron" [class.up]="isExpanded"></i>
    </div>
  </div>
  
  <div class="promise-content" [class.visible]="isExpanded">
    <div class="progress-bar-container">
      <div class="progress-bar-label">
        <span>Progresso Geral</span>
        <span>{{ promessa.ConclusaoPorcentagem }}%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-bar-fill" [style.width.%]="promessa.ConclusaoPorcentagem"></div>
      </div>
    </div>
    
    <p class="promise-details">{{ promessa.Descricao }}</p>
    
    <div class="subitems" *ngIf="promessa.Fases && promessa.Fases.length > 0">
      <h4>Detalhamento:</h4>
      
      <div class="subitem" *ngFor="let fase of promessa.Fases">
        <div class="subitem-header" (click)="toggleSubitem(fase.Titulo, $event)">
          <div class="subitem-title">{{ fase.Titulo }}</div>
          <div class="subitem-progress">
            <div class="progress-value">{{ fase.ConclusaoPorcentagem }}%</div>
            <i class="icon-chevron" [class.up]="isSubitemExpanded(fase.Titulo)"></i>
          </div>
        </div>
        
        <div class="subitem-content" [class.visible]="isSubitemExpanded(fase.Titulo)">
          <div class="progress-bar">
            <div class="progress-bar-fill" [style.width.%]="fase.ConclusaoPorcentagem"></div>
          </div>
          <p class="subitem-details">{{ fase.Descricao }}</p>
        </div>
      </div>
    </div>
  </div>
</div>
